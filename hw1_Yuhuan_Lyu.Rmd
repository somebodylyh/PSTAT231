---
title: "Homework Assignment"
author: "Yuhuan Lyu"
date: "`r format(Sys.Date(), '%B %d, %Y')`"
output: pdf_document
---


```{r setup, echo=FALSE}
library(knitr)
# set global chunk options: images will be 7x5 inches
knitr::opts_chunk$set(fig.width=7, fig.height=5)
options(digits = 4)

## indents are for indenting r code as formatted text
## They may need to be adjusted depending on your OS
# if your output looks odd, increase or decrease indent
indent1 = '    '
indent2 = '        '
indent3 = '            '
```


1. Descriptive summary statistics (10 pts in total) Given the lack of further information on the
    problem domain, it is wise to investigate some of the statistical properties of the data, so as to get a
    better grasp of the problem. It is always a good idea to start our analysis with some kind of exploratory
    data analysis. A first idea of the statistical properties of the data can be obtained through a summary
    of its descriptive statistics.
    * (2pts) Count the number of observations in each season using summarise() in dplyr.
```{r sd-function, indent=indent2}
library(dplyr)
algae_bloom <- read.table("algaeBloom.txt", header = FALSE, na.strings = "XXXXXXX")
algae_bloom %>%
    group_by(V1) %>%
    summarise(n = n())
```
    * (1 pts) Are there missing values in this dataset? (2 pts) Calculate the mean and variance of each
    chemical (Ignore a1 through a7). (1 pts) What do you notice about the magnitude of the two
    quantities for different chemicals?
```{r mad-function, indent=indent2}
library(dplyr)

algae_bloom <- read.table("algaeBloom.txt", 
                          header = FALSE,
                          na.strings = "XXXXXXX")

colnames(algae_bloom) <- c(
    "season", "size", "speed",           
    "pH", "temp", "oxygen", "chloride",  
    "nitrogen", "ammonia", "phosphate", "conductivity",  
    "a1", "a2", "a3", "a4", "a5", "a6", "a7" 
)

sum(is.na(algae_bloom)) 

chemicals <- algae_bloom %>%
    select(pH:conductivity)  

chemical_stats <- chemicals %>%
    summarise(across(everything(), 
                     list(mean = ~mean(., na.rm = TRUE),
                          var = ~var(., na.rm = TRUE))))

print(chemical_stats)
```
```{r mad-function, indent=indent2}
mean.abs.d <- function(x){
    n <- length(x) # Sample size
    m <- sum(abs(x - mean(x)))/n # mean average deviation
    return(m)
}
```

2. Construct box-plots, histograms, QQ-plots and kernel density estimates for
   these variables. Comment on features such as the distribution and outliers
   in these plots.  
   _When asked to construct a graph, you should always precede your graph by
   the R command/function that generated it properly annotated._
  
```{r age-data, out.width='0.4\\linewidth', fig.show='hold', indent=indent1}
library(MASS)
pima2 = rbind(Pima.tr, Pima.tr2, Pima.te)

x = pima2$age
var.name = 'age'
```


```{r, out.width='50%', fig.show='hold', indent=indent1}
library(ggplot2)

ggplot(pima2, aes(x=age)) + geom_histogram()

ggplot(pima2, aes(x = factor(0), y = age)) + geom_boxplot() + xlab("") +
    scale_x_discrete(breaks = NULL) + coord_flip()

y     <- quantile(pima2$age, c(0.25, 0.75)) # Find the 1st and 3rd quartiles
x     <- qnorm( c(0.25, 0.75))         # Find the matching normal values on the x-axis
slope <- diff(y) / diff(x)             # Compute the line slope
int   <- y[1] - slope * x[1]           # Compute the line intercept

ggplot(pima2, aes(sample=age)) + stat_qq() + 
    geom_abline(intercept=int, slope=slope, color='red')

```
